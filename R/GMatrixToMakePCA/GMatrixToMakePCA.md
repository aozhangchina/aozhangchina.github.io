# GMatrixToMakePCA

 

[TOC]

**制作：张敖 [https://datahold.cn](https://datahold.cn/)** 

# 鸣谢

张学才，CIMMYT，指导

陈珊，沈阳农业大学，测试

任姣姣，新疆农业大学，测试

## 最新更新

【2022-02-13】

增加3D图显示解释的遗传变异。

【2021-06-10】

增加画3D图。

增加图例和颜色的个性化设置。

修改了部分配色。

【2021-04-23】

增加了画每个PC变异情况的图。

【2021-01-23】

修正了分组文件使用csv格式报错的问题。

增加了排序对应功能，避免数据点对应错误。

修正了图例可能对应错误的问题。

【2020-08-17】

增加了国内线路。

【2020-05-14】

修正了一个颜色组错误。

【2020-02-27】

完成基本功能。

## 功能

1. HMP数值化。根据等位基因频率修改，最大等位基因频率1，最小等位基因频率0，杂合0.5。
2. 去除没有多态性的标记。
3. 根据可能性补缺失。
4. 可以选择是否分组，分组后，不同的组会用不同颜色的点和图形显示在图上。（最大支持5组）。
5. 生成PC1和PC2的图，括号里显示解释的变异百分比。

## 使用方法

准备hmp文件和分组文件（可选）

HMP文件如果过大，会导致程序非常慢，建议先用TASSEL筛选后再使用。

分组文件有两列，第一列为材料名，第二列为分组标记，保存成txt文件或csv文件。（**注意：分组文件无标题行！！！**）。

将下列代码复制到Rstudio，然后全选运行。期间会弹出对话框，先选择hmp格式的基因型文件，再选择分组文件（**注意**：没有分组文件点取消|**注意：文件名和路径不要包含中文**）。

海外：

```R
mycolor <- c("black","#E94B35","#2C97De","#FFB900","#9C56B8","#80CFBE","#357E94")   # 修改分组颜色
mypch <- c(21,22,23,24,25,20,19)   # 修改点的形状
legend_position <- "bottomleft"   # 修改图例位置 2D图有效
source("https://aozhangchina.github.io/R/GMatrixToMakePCA/GMatrixToMakePCA.r")   # 加载程序文件，需要联网
```

国内：

```R
mycolor <- c("black","#E94B35","#2C97De","#FFB900","#9C56B8","#80CFBE","#357E94")   # 修改分组颜色
mypch <- c(21,22,23,24,25,20,19)   # 修改点的形状
legend_position <- "bottomleft"   # 修改图例位置 2D图有效
source("https://dataholdcn.cn/R/GMatrixToMakePCA/GMatrixToMakePCA.r")   # 加载程序文件，需要联网
```

